
>[!tip] Created: [2025-09-19 Fri 13:13]

>[!question] Targets: 

>[!danger] Depends: 

if we have a gateway app that handles clerk, and then once the use has proved their clerkness, they get redirected to their computer.

they are their browser, rather than they are their computer, so they might have access to other computers based on their clerkid.

each computer is a folder on the server, named after their clerk id.
they can make other computers, but something in there points back to their clerkid.

have a gateway service that walks users thru the auth loop.  this is clustered.

Each computer has a clustered little image of fast machines that handle the incoming traffic, check auth, wake up workers, assign fibers to workers.

these are nameless and stateless.

we do several fly replay hops
1. hits the external gateway which handles auth
2. fly replay over to the computer the user is trying to hit after checking the auth
	1. look at the dns name and figure out the computer mapping
	2. fly-replay over to the app that represents the computer they are trying to hit
3. on the computer gateway machines, fly replay to the agent they want to hit
	1. check the auth allows them to connect with that agent, using just the nfs state



The nfs fiber state does not have to be commited to start with, as it can be just pure nfs disk persistence.  file locks ensure that the agent is exclusive on the file.

flat fiber ids for each agent, just monotonically increasing.
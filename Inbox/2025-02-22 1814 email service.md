
>[!tip] Created: [2025-02-22 Sat 18:14]

>[!question] Targets: 

>[!danger] Depends: 

need a two phase commit to ensure no double sends.

First the process needs to gain the send lock by way of a commit.

Then it registers its intention to commit, by storing some hash value, and keeping the original value in ram.  If it crashes, it won't have this value any more.

This lock would timeout eventually.

We might use a locking system inside of denokv to ensure we can operate without triggering commits ?  The lock service would be something like a repo lock, where the hosting infrastructure ensures that only one process is exclusively running.

Make a separate deployment for receiving the email notification, which just pushes the message onto the queue, to ensure that it was received, and then uses the queue to reliably retrieve the message ?

Or, just do the retrieval and storage in artifact before the sns message is affirmed, so SNS should rerty if there are issues.

Artifact should be able to set up external webhooks as a service easily, so any given repo would register with the sockets host or something.  Then we can package up SES as a type of wrapper service, so people can connect directly to.
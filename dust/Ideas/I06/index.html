<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-dust docs-doc-id-Ideas/I06">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Dreamcatcher RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Dreamcatcher Atom Feed"><title data-rh="true">I06 IPFS Rewrite | Dreamcatcher</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dreamcatcher.land/dust/Ideas/I06"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-dust-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-dust-current"><meta data-rh="true" property="og:title" content="I06 IPFS Rewrite | Dreamcatcher"><meta data-rh="true" name="description" content="Proposal Scope"><meta data-rh="true" property="og:description" content="Proposal Scope"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://dreamcatcher.land/dust/Ideas/I06"><link data-rh="true" rel="alternate" href="https://dreamcatcher.land/dust/Ideas/I06" hreflang="en"><link data-rh="true" rel="alternate" href="https://dreamcatcher.land/dust/Ideas/I06" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.71c2da89.css">
<link rel="preload" href="/assets/js/runtime~main.8e3693ec.js" as="script">
<link rel="preload" href="/assets/js/main.decc84e0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarContent_xLdY">ðŸš§ DRAFT - UNDER CONSTRUCTION ðŸš§</div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dreamcatcher.svg" alt="Dreamcatcher" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/dreamcatcher.svg" alt="Dreamcatcher" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/builders/">Do-ers</a><a class="navbar__item navbar__link" href="/investors/">Funders</a><a class="navbar__item navbar__link" href="/buyers/">Buyers</a><a class="navbar__item navbar__link" href="/live/">Live</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/store">Apps</a><a href="https://dreamcatcher-tech.github.io/dreamcatcher-stack/dev/bench" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Benchmarks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/contributing">Contributing</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dust/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dust/Requests/R01">Requests</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/dust/Ideas/I04">Ideas</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I04">I04 Securities Guardian</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I05">I05 Markdown NFT Mode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dust/Ideas/I06">I06 IPFS Rewrite</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I07">I07 Web Liquidity Pooling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I11">I11 Request-Idea</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I12">I12 WebDOS framework</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I13">I13 Patent Pooling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I14">I14 Cryptofree Liquidity Pooling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/nfas/Ideas/I15">I15 DC Website</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/nfas/Ideas/I16">I16 Test Pitch Reports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/nfas/Ideas/I17">I17 DC Portal Company Formation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I18">I18 InterPulse multithreading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I19">I19 IPFS Disassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I20">I20 Dreamcatcher Algorithm v0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dust/Ideas/I21">I21 IPORM the IPFS ORM</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ideas</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">I06 IPFS Rewrite</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>I06 IPFS Rewrite</h1><p><img loading="lazy" src="/assets/images/I06-96f21b6df587ea1e8a15b26aff152271.png" width="256" height="256" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="proposal-scope">Proposal Scope<a class="hash-link" href="#proposal-scope" title="Direct link to heading">â€‹</a></h2><p>Targets <a href="/dust/Requests/R06">06 Interblock</a> in all areas except privacy.</p><p>Because we have chosen to have a payload layer, and because our design treats all blocks as part of that payload layer, we are a seamless fit for IPFS which aims to be purely a payload layer. IPFS would be responsible for replacing our storage layer and network layer, which is an enormous amount of complexity that we can leverage from a popular and funded project.</p><p>IPFS does not currently have any sense of read permissions, nor multisig public cryptography, so we will need to add these layers in, hopefully in a way that can benefit the IPFS project as reusable components. An interim measure will be to use the private network feature of IPFS to form boundaries of non overlapping permissioned data until per chain permissioning can be implemented.</p><p>Some modifications to our models are required to fit this, but all the logic of chainmaking remains identical. There may be an extra step to asynchronously build up the parts of the block that are needed once we know what we need - specifically in <code>block.network</code> - but the upside is that <code>block.network</code> can grow to millions of chains and still function with performance being mostly a function of what changes you want to make, not what changes had previously been made.</p><p>During the course of this conversion we will treat permissioning and privacy as a separate layer, as it does not affect the data structure and transmission systems very much, the only exception being the layout of a block to allow interblocks to be formed that do not leak data about what other channels also received transmissions at the same block.</p><p>The utility of IPFS splits into two key areas: Liveliness, which is the means of propagating changes to chains, and Persistence, which is the means of storing, distributing, and retrieving chains.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="liveliness">Liveliness<a class="hash-link" href="#liveliness" title="Direct link to heading">â€‹</a></h2><p>Broadcasting in any network is a troublesome operation. After analysis of the protocols available in IPFS, broadcasting is significantly cheaper if a large number of different messages are sent to a single topic, rather than few messages sent to many topics. This is due to the cost of subscription to a topic. The principle we leverage to fit this model is that an AppRoot of any application is used as the topic for messages to notify a child of the AppRoot that there are new interblocks available to them to make new blocks out of.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="functions-required">Functions required<a class="hash-link" href="#functions-required" title="Direct link to heading">â€‹</a></h3><ol><li>Announce when new blocks of a chain are made to readers</li><li>Announce to destination when new interblocks are available from source</li><li>Recover latest block of a chain, having missed announce</li><li>Recover latest interblocks from source, having missed announce</li><li>Publish a permanent end for a validator sets combined public key, signalling turnover to a new validator set</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="announce-using-a-custom-dht--pubsub">Announce using a custom dht + pubsub<a class="hash-link" href="#announce-using-a-custom-dht--pubsub" title="Direct link to heading">â€‹</a></h4><p>We need to make a custom dht in libp2p and set the validate and select functions to only relay blocks. There is a significant weakness in that a rogue validator set can turnover and then continue to publish, which will confuse some nodes, unless each node looks up the block turnover history to validate it properly before validating.</p><p>Initially for our version this problem will not be tackled, and any block with a valid signature scheme will be passed. The selector will operate solely on the heights of each block, whereas later it should walk the tree and determine which is latest.</p><p>The key:value pair in the dht is <code>chainId:CID</code> and we will walk the tree to check it. In prototyping, any publication will pass.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="announcing-new-blocks">Announcing new blocks<a class="hash-link" href="#announcing-new-blocks" title="Direct link to heading">â€‹</a></h3><p>To avoid flooding the broadcast channels of IPFS (or any announcement system), change subscriptions are voluntarily kept to approot chains, altho they are permitted to be anything. The root of the app is guaranteed to change if any of the children change. The approot is the method of crosschain consistency for running queries.</p><p>Using pubsub in IPFS, each chainId is a broadcast topic. Correctly functioning validators will only broadcast when approots change. Upon receipt, each peer checks the signature of the block and if it fails it should stop gossiping the message.</p><p>Worst case we have a single validator, so we can just use IPNS to publish.</p><p>This DHT put is required for peers that missed an announcement. Each new block is also announced using pubsub. The same problems occur here as with put, and are handled the same way. Again a custom libp2p implementation may be needed.</p><p>Whenever a new block is received, the client and the server should pin it recursively, as this is the approot.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="announcing-new-interblocks">Announcing new interblocks<a class="hash-link" href="#announcing-new-interblocks" title="Direct link to heading">â€‹</a></h3><p>Listeners in the target chain subscribe to the topic of targetChainId:sourceChainId. Once the permissions layer is implemented, they would just listen to the sourceChainId topic, and would only receive notifications when something they can access is part of the latest block</p><p>The principle is that if you have a request that you need processed, you need to keep announcing until you receive a reply. There is no point storing these values anywhere.</p><p>Publish by putting a value in the DHT so that if someone comes looking, they&#x27;ll be able to find it, published by srcChainId-dstChainId:hash-height</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="catching-up">Catching up<a class="hash-link" href="#catching-up" title="Direct link to heading">â€‹</a></h3><p>Upon first seek, or periodically when a node suspects it might be behind announcements, the node needs to get the best known latest block. There are two ways to do this, which will be subject to testing.</p><p>Firstly, we can store the value directly in the DHT. Nodes would validate this value when received to make sure they agree with it before passing it on. This is the preferred method, provided we can stop forwarding malicious data, and we can update efficiently.</p><p>Secondly, we can use the IPNS system to publish versioned updates. Versions are numbered, and so these would coincide with block heights. Currently the IPNS system only supports signatures from a single key, so this method only supports single validator usage. Perhaps later we can modify it to support a set of validators, but then another problem is leaking information where the same validatorset is responsible for multiple chains.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="speeding-up-first-sync">Speeding up first sync<a class="hash-link" href="#speeding-up-first-sync" title="Direct link to heading">â€‹</a></h3><p>CAR files are a single archive of a tree of IPFS data. We should speed up time to first sync for clients by providing CAR files that snapshot the application state periodically. This will be especially useful for browser clients, however the applications should function sufficiently well if synchronization is from scratch reassembling DAGs.</p><p>The design of Interblock and its web components has always considered data arriving asynchronously, as all UI components are reactive, so speed of sync should be less of an issue. Browser clients currently store data in indexeddb so they will only need to sync data they missed while offline each time</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="persisting-app-state-on-the-clients">Persisting app state on the clients<a class="hash-link" href="#persisting-app-state-on-the-clients" title="Direct link to heading">â€‹</a></h3><p>IPFS has a function called pinning, and we should use this to pin the approot of each chain periodically, each time a new approot block is discovered. We may choose to unpin the previous block, but this will be a performance based decision, and not critical initially. In this way, all web clients with the webrtc protocol enabled, can help others sync faster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scrubbing-the-chain-periodically">Scrubbing the chain periodically<a class="hash-link" href="#scrubbing-the-chain-periodically" title="Direct link to heading">â€‹</a></h3><p>We will need to make a walker that periodically checks that latest has all its data present, then proceeds backwards in time, to ensure that all data is available.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="persistence">Persistence<a class="hash-link" href="#persistence" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="chain">Chain<a class="hash-link" href="#chain" title="Direct link to heading">â€‹</a></h3><p>This is a reverse trickle DAG which has as leaves pointers to every block.
The root hash of this DAG represents the LATEST hash. Benefit is that getting an arbitrary height can be looked up near instantly, rather than having to walk the chain one block at a time. The old version of chain was literally a chain, but this new version should be a tree, to give this rapid lookup ability based on height.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="block">Block<a class="hash-link" href="#block" title="Direct link to heading">â€‹</a></h3><p>This stays largely the same, except internally the IPLD datamodel is applied</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network">Network<a class="hash-link" href="#network" title="Direct link to heading">â€‹</a></h3><p>This will be left alone if possible, but we might change firstly that we build it up asynchronously, allowing efficiency as it gets large, and secondly that we might move to a HAMT which allows millions of children. HAMT needs performance checking. We need to make sure that holes are repacked in the network tree, so the tree does not shuffle, but this might not actually matter if we use named links.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="channel">Channel<a class="hash-link" href="#channel" title="Direct link to heading">â€‹</a></h3><p>This is an interesting structure, since it acts as a splice point to connect to the DAG or another chain. In the <code>precedent</code> field, it maintains a pointer to the latest block from the remote chain that transmitted to it. Walking this DAG it finds what messages are due to it based on its chainId. This will be tricky to implement privacy on, as the content request needs to be done as tho</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="interblocks">Interblocks<a class="hash-link" href="#interblocks" title="Direct link to heading">â€‹</a></h3><p>These point directly at the blocks of the transmitting channel so are no longer a thing. The permissions layer will restrict how receiving chains can walk the DAG of transmitting chains.</p><p>The <code>block.transmission</code> slice points now to the CID of the channel tip</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="state">State<a class="hash-link" href="#state" title="Direct link to heading">â€‹</a></h3><p>State allows using CIDs if the developer wants to, which can make anything in the IPLD be referenced and mutated by chains, by wrapping them in state.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="converting-existing-models">Converting existing models<a class="hash-link" href="#converting-existing-models" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-model">Network model<a class="hash-link" href="#network-model" title="Direct link to heading">â€‹</a></h3><p>This was designed to be very large and fast using ImmutableJS. Using IPLD opens up a new possibility for scale, as a network object of unlimited size can be created, and walked only for the specific pieces required during blockmaking. Using tools like the <a href="https://github.com/rvagg/js-ipld-hashmap" target="_blank" rel="noopener noreferrer">IPLD HAMT</a> we might be able to achieve megachain without implementing the proxy pattern for chains.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overlay-dags-within-the-app-complex">Overlay DAGs within the App Complex<a class="hash-link" href="#overlay-dags-within-the-app-complex" title="Direct link to heading">â€‹</a></h2><p>A chain application is made up of an approot and any number of children. Within this tree of children, there are 3 overlay DAGs which can be navigated directly:</p><ol><li>The state tree (the knowledge of the complex)</li><li>The metadata tree (the liveliness of the complex)</li><li>The binary tree (the files of the complex)</li></ol><p>Each of these is referenced and pushed up to the root. This allows the state hash to be queried for when it changes, and know that none of the child states changed either.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="entering-the-system">Entering the system<a class="hash-link" href="#entering-the-system" title="Direct link to heading">â€‹</a></h2><p>The binary data can be attached directly to a pierce chain, or it can be attached using IPFS and then a CID provided to the chain. The validators will fetch the CID and verify the hashes before including reference to this data in any blocks</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="locking-of-chains">Locking of chains<a class="hash-link" href="#locking-of-chains" title="Direct link to heading">â€‹</a></h2><p>This is only required within any process that has access to the crypto keys of this node. This lock process cannot be within IPFS because it needs to be very quick, and should never leave the node. In lambda, this would probably be done through dynamodb, or it might be done as blocks in an internal chain to give high level locks, then fast local locks within each 6 core runner.</p><p>In an algorithm like tendermint, locking is handled loosely and within the protocol, so here locking refers to only within the node itself, to provide consistent and compliant use of the precious crypto keys.</p><p>The npm package <a href="https://www.npmjs.com/package/mortice" target="_blank" rel="noopener noreferrer"><code>mortice</code></a> which is used by IPFS might be useful for locking on the same machine.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="benefits-over-existing-implementation">Benefits over existing implementation<a class="hash-link" href="#benefits-over-existing-implementation" title="Direct link to heading">â€‹</a></h2><ol><li>Interblocks are not produced, nor sent, but rather the permissions layer will only give access to the destination chain from the source for the narrow slice</li><li>Network size in a block can be near infinite with no overhead</li><li>Whole applications of a tree of chains can be bundled up into a single archive and downloaded to sync rapidly</li><li>Storage space is used nearly as efficiently as possible with very little performance overhead</li><li>Lambda functions can now make their own internal high performance cache network that makes use of the temporary disk space each function gets</li><li>Lambda functions can operate without S3</li><li>Our public blockchain can have truly public data right from launch</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="faqs">FAQs<a class="hash-link" href="#faqs" title="Direct link to heading">â€‹</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-will-devs-access-the-full-block-inside-a-reducer-">How will devs access the full block inside a reducer ?<a class="hash-link" href="#how-will-devs-access-the-full-block-inside-a-reducer-" title="Direct link to heading">â€‹</a></h4><p>They have to use an async function to query the block anyway, so they will have to make several async calls once they know what the block.network path they want is.</p><p>Questions:</p><ol><li>Can a UnixFS file also contain a custom IPLD format, so we can blend the payload layer tree and showing the state of each node ?</li><li>Does throwing in the pubsub handler in ipfs perform the same result as a validator in libp2p pubsub ?</li><li>How is the performance of the IPLD primitives ? Can we use them in the intermediate states, or should we stick to our objects and only stamp down to IPLD at blockmaking time ?</li><li>How big are ints in the IPLD datamodel ? 2^53 due to implementation in JS</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="problems">Problems<a class="hash-link" href="#problems" title="Direct link to heading">â€‹</a></h2><ol><li>Browser peers need access to a signalling server to use webrtc: <a href="https://github.com/libp2p/js-libp2p-webrtc-star/tree/master/packages/webrtc-star-signalling-server" target="_blank" rel="noopener noreferrer">https://github.com/libp2p/js-libp2p-webrtc-star/tree/master/packages/webrtc-star-signalling-server</a> - but a desktop node might do this automatically once it gets discovered by the browsers</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="goals">Goals<a class="hash-link" href="#goals" title="Direct link to heading">â€‹</a></h2><ol><li>Perform well over lan on a private network - ignore public network performance</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-order">Implementation order<a class="hash-link" href="#implementation-order" title="Direct link to heading">â€‹</a></h2><ol><li>Data structures overview via writing schema</li><li>Convert model system over to use IPLD models</li><li>Build hash functions with rough benchmarks</li><li>Check producers still operate correctly</li><li>Modify Engine to use IPFS to store pools</li><li>Cache ioConsistency using block.bytes.length as the capacity</li><li>Modify Engine to fully resolve DAGs before blockmaking</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dreamcatcher-tech/dreamcatcher-tech.github.io/edit/master/website/dust/Ideas/I06.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/dust/Ideas/I05"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">I05 Markdown NFT Mode</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dust/Ideas/I07"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">I07 Web Liquidity Pooling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#proposal-scope" class="table-of-contents__link toc-highlight">Proposal Scope</a></li><li><a href="#liveliness" class="table-of-contents__link toc-highlight">Liveliness</a><ul><li><a href="#functions-required" class="table-of-contents__link toc-highlight">Functions required</a></li><li><a href="#announcing-new-blocks" class="table-of-contents__link toc-highlight">Announcing new blocks</a></li><li><a href="#announcing-new-interblocks" class="table-of-contents__link toc-highlight">Announcing new interblocks</a></li><li><a href="#catching-up" class="table-of-contents__link toc-highlight">Catching up</a></li><li><a href="#speeding-up-first-sync" class="table-of-contents__link toc-highlight">Speeding up first sync</a></li><li><a href="#persisting-app-state-on-the-clients" class="table-of-contents__link toc-highlight">Persisting app state on the clients</a></li><li><a href="#scrubbing-the-chain-periodically" class="table-of-contents__link toc-highlight">Scrubbing the chain periodically</a></li></ul></li><li><a href="#persistence" class="table-of-contents__link toc-highlight">Persistence</a><ul><li><a href="#chain" class="table-of-contents__link toc-highlight">Chain</a></li><li><a href="#block" class="table-of-contents__link toc-highlight">Block</a></li><li><a href="#network" class="table-of-contents__link toc-highlight">Network</a></li><li><a href="#channel" class="table-of-contents__link toc-highlight">Channel</a></li><li><a href="#interblocks" class="table-of-contents__link toc-highlight">Interblocks</a></li><li><a href="#state" class="table-of-contents__link toc-highlight">State</a></li></ul></li><li><a href="#converting-existing-models" class="table-of-contents__link toc-highlight">Converting existing models</a><ul><li><a href="#network-model" class="table-of-contents__link toc-highlight">Network model</a></li></ul></li><li><a href="#overlay-dags-within-the-app-complex" class="table-of-contents__link toc-highlight">Overlay DAGs within the App Complex</a></li><li><a href="#entering-the-system" class="table-of-contents__link toc-highlight">Entering the system</a></li><li><a href="#locking-of-chains" class="table-of-contents__link toc-highlight">Locking of chains</a></li><li><a href="#benefits-over-existing-implementation" class="table-of-contents__link toc-highlight">Benefits over existing implementation</a></li><li><a href="#faqs" class="table-of-contents__link toc-highlight">FAQs</a></li><li><a href="#problems" class="table-of-contents__link toc-highlight">Problems</a></li><li><a href="#goals" class="table-of-contents__link toc-highlight">Goals</a></li><li><a href="#implementation-order" class="table-of-contents__link toc-highlight">Implementation order</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">White Papers</a></li><li class="footer__item"><a class="footer__link-item" href="/contributing/">Contributing</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/channel/UCysqnESDAhA0NzfbS1GI9YQ/videos" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/ZfTkcgaEmh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/dreamcatcher-tech/dreamcatcher-tech.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Dreamcatcher.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8e3693ec.js"></script>
<script src="/assets/js/main.decc84e0.js"></script>
</body>
</html>